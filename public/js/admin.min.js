/*! www.rack.pub Ron Royston vBeta 2016 License: https://tldrlegal.com/license/mit-license */
function setNode(e){if(e){var t=ref.child("testLocation"),a={};a[e]=!0,t.update(a,onComplete)}}function initStates(){states.push(["al","alabama"]),states.push(["ak","alaska"]),states.push(["az","arizona"]),states.push(["ar","arkansas"]),states.push(["ca","california"]),states.push(["co","colorado"]),states.push(["ct","connecticut"]),states.push(["de","delaware"]),states.push(["fl","florida"]),states.push(["ga","georgia"]),states.push(["hi","hawaii"]),states.push(["id","idaho"]),states.push(["il","illinois"]),states.push(["in","indiana"]),states.push(["ia","iowa"]),states.push(["ks","kansas"]),states.push(["ky","kentucky"]),states.push(["la","louisiana"]),states.push(["me","maine"]),states.push(["md","maryland"]),states.push(["ma","massachusetts"]),states.push(["mi","michigan"]),states.push(["mn","minnesota"]),states.push(["ms","mississippi"]),states.push(["mo","missouri"]),states.push(["mt","montana"]),states.push(["ne","nebraska"]),states.push(["nv","nevada"]),states.push(["nh","new hampshire"]),states.push(["nj","new jersey"]),states.push(["nm","new mexico"]),states.push(["ny","new york"]),states.push(["nc","north carolina"]),states.push(["nd","north dakota"]),states.push(["oh","ohio"]),states.push(["ok","oklahoma"]),states.push(["or","oregon"]),states.push(["pa","pennsylvania"]),states.push(["ri","rhode island"]),states.push(["sc","south carolina"]),states.push(["sd","south dakota"]),states.push(["tn","tennessee"]),states.push(["tx","texas"]),states.push(["ut","utah"]),states.push(["vt","vermont"]),states.push(["va","virginia"]),states.push(["wa","washington"]),states.push(["wv","west virginia"]),states.push(["wi","wisconsin"]),states.push(["wy","wyoming"]),states.push(["as","american samoa"]),states.push(["dc","district of columbia"]),states.push(["fm","federated states of micronesia"]),states.push(["gu","guam"]),states.push(["mh","marshall islands"]),states.push(["mp","northern mariana islands"]),states.push(["pw","palau"]),states.push(["pr","puerto rico"]),states.push(["vi","virgin islands"])}function initDays(){days.push(["all days"]),days.push(["sunday"]),days.push(["monday"]),days.push(["tuesday"]),days.push(["wednesday"]),days.push(["thursday"]),days.push(["friday"]),days.push(["saturday"])}function initTod(){tod.push(["anytime"]),tod.push(["morning"]),tod.push(["noon"]),tod.push(["afternoon"]),tod.push(["evening"]),tod.push(["midnight"])}function initCheckBoxIds(){checkBoxIds.push(["childcare","#lblChildcare"]),checkBoxIds.push(["onlyMen","#lblMensOnly"]),checkBoxIds.push(["onlyWomen","#lblWomensOnly"]),checkBoxIds.push(["meditation","#lblMeditation"]),checkBoxIds.push(["speaker","#lblSpeaker"]),checkBoxIds.push(["step","#lblStep"]),checkBoxIds.push(["spanish","#lblSpanish"]),checkBoxIds.push(["bigBook","#lblBigBook"]),checkBoxIds.push(["discussion","#lblDiscussion"]),checkBoxIds.push(["tradition","#lblTradition"]),checkBoxIds.push(["beginner","#lblBeginner"])}function loadMemberPage(){loadImage(authData),ref.child("users").child(authData.uid).once("value").then(function(e){e.val()&&loadDiv(1==e.val().isAdmin?"admin":"verify")},function(e){tools.toast("Error: ",e)})}function loadDiv(e,t){$(".msg").html("Loading HTML..."),new Firebase("https://ack.firebaseio.com/markup/"+e).once("value").then(function(a){switch(e){case"addMeeting":$("#"+e).html(a.val()),$("#dock").on("blur","#meetingZip",function(){watchInputs()}),$("#dock").on("click","#submit",handleSubmit);break;case"meetings":$("#"+e).html(a.val()),loadDdState(),$("#newMeeting").click(function(){loadDiv("meetingTemplate")});break;case"meetingTemplate":$("#meetings").html(a.val()),t&&fillMeetingTemplate(t),$(".ddsd").on("change",function(){$(".ddsd").css({color:"#757575","font-weight":"300"})}),$(".ddst").on("change",function(){$(".ddst").css({color:"#757575","font-weight":"300"})}),$("#dock").on("blur","#meetingZip",function(){watchInputs()}),$("#delete").show().click(function(){tools.removeMeeting()}),$("#cancel").click(function(){loadDiv("meetings")}),$("#submit").click(function(){verifySubmit()});break;case"login":$("#dock").html(a.val()),$("#dock").on("click","#facebook,#google,#twitter",authenticate),$("#loginCancel").click(function(e){window.location.href="../"});break;case"admin":$("#dock").html(a.val()),$(".mdl-tabs__tab").click(function(e){var t=$(this).attr("href");tabListener(t)}),$("#marquee").html("Administration Portal");break;case"administrator":$("#"+e).html(a.val());break;case"import":$("#"+e).html(a.val());var o=document.getElementById("dropzone");document.getElementById("files");o.addEventListener("dragenter",dragenter,!1),o.addEventListener("dragover",dragover,!1),o.addEventListener("drop",drop,!1),document.getElementById("files").addEventListener("change",handleFileSelect,!1);break;case"verify":$("#dock").html(a.val()),$("#exitVerify").click(function(e){var t=getName(authData);$("#chip").hide("slow"),ref.child("users").child(authData.uid).remove(),tools.toast(t+" deleted from Administrator Database"),ref.unauth(),authData={},loadDiv("login")}),$("#agree").click(function(e){var t=document.querySelector("#continue");this.checked?t.disabled=!1:t.disabled=!0}),$("#continue").click(function(e){ref.child("users").child(authData.uid).update({isAdmin:!0}),loadDiv("admin")})}"undefined"!=typeof componentHandler&&componentHandler.upgradeAllRegistered()},function(e){tools.toast("Permission Denied.",e)})}function toTitleCase(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function adminInit(){loadDiv("administrator")}function tabListener(e){var t=$(e).html();switch(-1==t.search(".ajaxed")&&loadDiv(e.substr(1)),e){case"#administrator":$("#marquee").html("Administration Portal");break;case"#meetings":$("#marquee").html("Meetings");break;case"#users":$("#marquee").html("Users")}}function loadDdState(){ref.child("states").once("value").then(function(e){e.forEach(function(e){$("#ddState").append($("<option></option>").attr("value",e.key()).text(e.key()))}),$("#ddState").removeAttr("disabled").css({color:"#424242"}).on("change",function(){loadDdCity(this.value)})},function(e){console.error(e)})}function loadDdCity(e){$("#ddCity").empty(),ref.child("states").child(e).once("value").then(function(t){t&&($("#ddCity,#ddDay,#ddTimeOfDay").css("color","#424242"),t.forEach(function(e){$("#ddCity").append($("<option></option>").attr("value",e.key()).text(e.key()))}),$.isEmptyObject(days)&&initDays(),$.each(days,function(e,t){$("#ddDay").append($("<option></option>").attr("value",t).text(t))}),$.isEmptyObject(tod)&&initTod(),$.each(tod,function(e,t){$("#ddTimeOfDay").append($("<option></option>").attr("value",t).text(t))}),$("#ddCity,#ddDay,#ddTimeOfDay").removeAttr("disabled"),$("#play").removeAttr("disabled").on("click",function(){$(".listing").html('<div class="loader"><div class="mdl-spinner mdl-js-spinner is-active"></div></div>');var t=$("#ddCity").val();loadMeetings(t,e)}))},function(e){console.error(e)})}function loadMeetings(e,t){var a=$("#ddDay").val().toLowerCase(),o=$("#ddTimeOfDay").val().toLowerCase(),i="";return ref.child("states").child(t).child(e).once("value").then(function(e){var t=[];return e.forEach(function(e){var a=e.key(),o=ref.child("meetings").child(a).once("value").then(function(e){return e.val()},function(e){console.error(e)});t.push(o)}),Promise.all(t)},function(e){tools.toast("ERROR: "+e)}).then(function(e){var t='<ul class="meetings-list mdl-list">';$.each(e,function(e,s){"am"==s.timeframe?i="morning":"noon"==s.timeframe?i="noon":"midnight"==s.timeframe?i="midnight":"pm"==s.timeframe&&(s.hour>=12&&s.hour<=4&&(i="afternoon"),s.hour>=5&&s.hour<=11&&(i="evening")),(a===s.day||"all days"===a)&&(o===i||"anytime"===o)&&(t+='<li class="mdl-list__item mdl-list__item--two-line">',t+='<span class="mdl-list__item-secondary-action">',t+="</span>",t+='<span class="mdl-list__item-primary-content">',t+='<span><button id = "'+s.key+'" class="mdl-button mdl-js-button mdl-button--primary aMeeting">'+s.name+"</button></span>",t+='<span class="mdl-list__item-sub-title">'+s.street+" "+s.day+'<span class="lowercase">s at </span>'+s.hour+s.timeframe+"</span>",t+="</span>",t+='<span class="mdl-list__item-secondary-content">',t+='<a class="mdl-list__item-secondary-action" href="#">',t+=s.meetingOpen?'<i class="material-icons" id="openMeeting'+s.key+'">radio_button_unchecked</i><div class="mdl-tooltip" for="openMeeting'+s.key+'">Open Meeting</div>':'<i class="material-icons" id="closedMeeting'+s.key+'">change_history</i><div class="mdl-tooltip" for="closedMeeting'+s.key+'">Closed Meeting</div>',s.onlyMen&&(t+='<i class="material-icons" id="mensOnly'+s.key+'">star</i><div class="mdl-tooltip" for="mensOnly'+s.key+'">Mens Only</div>'),s.onlyWomen&&(t+='<i class="material-icons" id="womensOnly'+s.key+'">star_border</i><div class="mdl-tooltip" for="womensOnly'+s.key+'">Womens Only</div>'),s.beginner&&(t+='<i class="material-icons" id="beginner'+s.key+'">format_bold</i><div class="mdl-tooltip" for="beginner'+s.key+'">Beginner</div>'),s.bigBook&&(t+='<i class="material-icons" id="bigBook'+s.key+'">local_library</i><div class="mdl-tooltip" for="bigBook'+s.key+'">Big Book</div>'),s.childcare&&(t+='<i class="material-icons" id="childcare'+s.key+'">child_care</i><div class="mdl-tooltip" for="childcare'+s.key+'">Childcare</div>'),s.discussion&&(t+='<i class="material-icons" id="discussion'+s.key+'">question_answer</i><div class="mdl-tooltip" for="discussion'+s.key+'">Discussion</div>'),s.meditation&&(t+='<i class="material-icons" id="meditation'+s.key+'">event_seat</i><div class="mdl-tooltip" for="meditation'+s.key+'">Meditation</div>'),s.spanish&&(t+='<i class="material-icons" id="espanol'+s.key+'">language</i><div class="mdl-tooltip" for="espanol'+s.key+'">Spanish</div>'),s.speaker&&(t+='<i class="material-icons" id="speaker'+s.key+'">mic</i><div class="mdl-tooltip" for="speaker'+s.key+'">Speaker</div>'),s.tradition&&(t+='<i class="material-icons" id="tradition'+s.key+'">flip</i><div class="mdl-tooltip" for="tradition'+s.key+'">Tradition</div>'),s.step&&(t+='<i class="material-icons" id="step'+s.key+'">format_list_numbered</i><div class="mdl-tooltip" for="step'+s.key+'">Step</div>'),t+="</a>",t+="</span>",t+="</li><hr>")}),t+="</ul>",$(".listing").html(t),$("#meetingsArea").on("click",".aMeeting",loadMeetingTemplate),"undefined"!=typeof componentHandler&&componentHandler.upgradeAllRegistered()})}function loadMeetingTemplate(e){loadDiv("meetingTemplate",this.id)}function fillMeetingTemplate(e){ref.child("meetings").child(e).once("value").then(function(e){initCheckBoxIds();var t=document.querySelector("#meetingName"),a=document.querySelector("#meetingSiteNotes");t.dataset.latitude=Number(e.val().latitude),t.dataset.longitude=Number(e.val().longitude),t.dataset.key=e.val().key;var o=document.querySelector("#meetingStreet"),s=document.querySelector("#meetingCity"),n=document.querySelector("#meetingState"),r=document.querySelector("#meetingZip"),l=(document.querySelector("#latitude"),document.querySelector("#longitude"),document.querySelector("#weekday")),d=document.querySelector("#hour"),c=document.querySelector("#minute"),u=document.querySelector("#timeframe");for(t.parentElement.MaterialTextfield.change(e.val().name),a.parentElement.MaterialTextfield.change(e.val().siteNotes),o.parentElement.MaterialTextfield.change(e.val().street),s.parentElement.MaterialTextfield.change(e.val().city),n.parentElement.MaterialTextfield.change(e.val().state),r.parentElement.MaterialTextfield.change(e.val().zip),1==e.val().meetingOpen&&(document.querySelector("#openMeeting").parentNode.MaterialRadio.check(),document.querySelector("#closedMeeting").parentNode.MaterialRadio.uncheck()),l.value=e.val().day,d.value=e.val().hour,c.value=e.val().min,u.value=e.val().timeframe,$(".ddsd").css({color:"#757575","font-weight":"300"}),$(".ddst").css({color:"#757575","font-weight":"300"}),i=0;i<checkBoxIds.length;i++){var m=checkBoxIds[i][1],h=checkBoxIds[i][0];1==e.val()[h]&&document.querySelector(m).MaterialCheckbox.check()}},function(e){tools.toast("Error: Load Meeting Failed, "+e)})}function authenticate(e){e.preventDefault(),ref.authWithOAuthPopup(this.id,function(e,t){e?"TRANSPORT_UNAVAILABLE"===e.code&&ref.authWithOAuthRedirect(this.id,function(e){}):t&&ref.child("users").child(t.uid).once("value").then(function(e){e.val()?controller.onLoggedIn():(ref.child("users").child(t.uid).set({provider:t.provider,name:getName(t),roleValue:5,isAdmin:!1}),controller.onLoggedIn())},function(e){console.error(e)})},{})}function getName(e){if(e)switch(e.provider){case"google":return toTitleCase(e.google.displayName);case"twitter":return toTitleCase(e.twitter.displayName);case"facebook":return toTitleCase(e.facebook.displayName)}}function logout(){ref.unauth(),controller.onLoggedOut()}function getProfileImage(e){if(e)switch(e.provider){case"google":return e.google.profileImageURL;case"twitter":return e.twitter.profileImageURL;case"facebook":return e.facebook.profileImageURL}}function loadImage(e){$("#chip").show(),$("#chip").html('<img class="round" height="36" src="'+getProfileImage(e)+'" alt="'+getName(e)+'"><span class=""> '+getName(e)+'</span><span id="close"> &times;&nbsp;&nbsp;</span>'),$("#chip").click(logout)}function watchInputs(){var e=$("#meetingStreet").val(),t=$("#meetingCity").val(),a=$("#meetingState").val(),o=$("#meetingZip").val();(""!==e.trim()||""!==t.trim())&&geoCode(e,t,a,o)}function geoCode(e,t,a,o){var i=new google.maps.Geocoder,s=e+" "+t+" "+a+" "+o;i.geocode({address:s},function(e,t){if(t===google.maps.GeocoderStatus.OK){var a=e[0].geometry.location,o=a.toString().slice(1,-1).split(", "),i=document.querySelector("#meetingName");i.dataset.latitude=parseFloat(o[0]),i.dataset.longitude=parseFloat(o[1])}else tools.toast("Map location not found.  Please adjust address.  Error: ",t)})}function verifySubmit(){var e=$("#meetingState").val().toLowerCase(),t=$("#meetingStreet").val().toLowerCase(),a=$("#weekday option:selected").text().toLowerCase(),o=$("#hour option:selected").text(),s=$("#minute option:selected").text(),n=$("#timeframe option:selected").text().toLowerCase(),r=document.querySelector("#meetingName"),l=!1,d="";for(initStates(),i=0;i<states.length;i++){var c=states[i][0],u=states[i][1];switch(e){case c:d=u,l=!0;break;case u:l=!0}}l?""==r.dataset.key?tools.isDuplicate(d,t,o,s,a,n):handleSubmit(d):(tools.toast("State not found!"),$("#meetingState").focusin())}function handleSubmit(e){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,a="x"==e?t:3&t|8;return a.toString(16)}),a=document.querySelector("#meetingName");a.dataset.key?t=a.dataset.key:a.dataset.key=t;var o=$("#meetingName").val().toLowerCase().replace(/[.$#\[\]\/]/g,""),i=$("#meetingSiteNotes").val().toLowerCase().replace(/[.$#\[\]\/]/g,""),s=$("#meetingStreet").val().toLowerCase().replace(/[.$#\[\]\/]/g,""),n=$("#meetingCity").val().toLowerCase().replace(/[.$#\[\]\/]/g,"");e||(e=$("#meetingState option:selected").text().toLowerCase());var r=$("#meetingZip").val().replace(/[.$#\[\]\/]/g,""),l=Number(a.dataset.latitude),d=Number(a.dataset.longitude),c=$("#weekday option:selected").text().toLowerCase(),u=$("#hour option:selected").text(),m=$("#minute option:selected").text(),h=$("#timeframe option:selected").text().toLowerCase(),p=!1,f=!1,g=!1,y=!1,v=!1,k=!1,w=!1,x=!1,b=!1,C=!1,S=!1,D=!1;$("#openMeeting").is(":checked")&&(p=!0),$("#mensOnly").is(":checked")&&(f=!0),$("#womensOnly").is(":checked")&&(g=!0),$("#childcare").is(":checked")&&(y=!0),$("#meditation").is(":checked")&&(v=!0),$("#speaker").is(":checked")&&(k=!0),$("#step").is(":checked")&&(w=!0),$("#spanish").is(":checked")&&(x=!0),$("#bigBook").is(":checked")&&(b=!0),$("#discussion").is(":checked")&&(C=!0),$("#tradition").is(":checked")&&(S=!0),$("#beginner").is(":checked")&&(D=!0),ref.child("meetings").child(t).set({name:o,siteNotes:i,street:s,city:n,state:e,zip:r,latitude:l,longitude:d,day:c,hour:u,min:m,timeframe:h,timestamp:clock.now,user:authData.uid,author:getName(authData),meetingOpen:p,onlyMen:f,onlyWomen:g,childcare:y,meditation:v,speaker:k,step:w,spanish:x,bigBook:b,discussion:C,tradition:S,beginner:D,key:t},setGeofire(t,l,d,o)),setCity(n,e,t)}function setCity(e,t,a){if(e&&t&&a){var o=ref.child("states"),i=o.child(t),s=i.child(e),n={};n[a]=!0,s.update(n,onComplete)}}function setGeofire(e,t,a,o){geofire.set(e,[t,a]).then(function(){},function(e){tools.toast(o+" geolocation data storage error: ",e)})}function upload(e,t){var a=ref.child("markup"),o={};o[e]=t,a.update(o)}function updateAdmin(e,t){var a=ref.child("users").child(e);a.update({isAdmin:t})}function importJson(e){$.getJSON(e,function(e){var t=1;$.each(e,function(e,a){setTimeout(function(){var e=a.state.toLowerCase(),t=a.street.toLowerCase().replace(/[.$#\[\]\/]/g,""),o=a.hour,i=a.min,s=a.day.toLowerCase(),n=a.timeframe.toLowerCase();-1==$.inArray(e,tools.statesArray)?ref.child("meetings").orderByChild("state").equalTo(e).once("value").then(function(r){tools.statesArray.push(e),r.forEach(function(e){tools.meetingsArray.push(e)}),tools.isDup(e,t,o,i,s,n)?element.out.appendChild(document.createTextNode("Error: Duplicate Found. Key is "+a.key+"<br>")):geoCoder(a)},function(e){element.out.appendChild(document.createTextNode("Error: "+e+"<br>"))}):tools.isDup(e,t,o,i,s,n)?element.out.appendChild(document.createTextNode("Error: Duplicate Found. Key is "+a.key+"<br>")):geoCoder(a)},1200*t),t++})})}function geoCoder(e){var t=new google.maps.Geocoder,a=e.street+" "+e.city+" "+e.state+" "+e.zip,o=document.createElement("p"),i=document.getElementById("out");t.geocode({address:a},function(t,a){if(a===google.maps.GeocoderStatus.OK){var s=t[0].geometry.location,n=s.toString().slice(1,-1).split(", ");e.latitude=n[0],e.longitude=n[1],writeFirebase(e)}else{var r=document.createTextNode("ERROR Geolocating "+e.key);o.className="output",o.appendChild(r),i.appendChild(o)}})}function writeFirebase(e){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,a="x"==e?t:3&t|8;return a.toString(16)}),a=document.getElementById("out");ref.child("meetings").child(t).set({name:e.name.toLowerCase().replace(/[.$#\[\]\/]/g,""),siteNotes:e.siteNotes.toLowerCase().replace(/[.$#\[\]\/]/g,""),street:e.street.toLowerCase().replace(/[.$#\[\]\/]/g,""),city:e.city.toLowerCase().replace(/[.$#\[\]\/]/g,""),state:e.state.toLowerCase(),zip:e.zip,latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude),day:e.day.toLowerCase(),hour:e.hour,min:e.min,timeframe:e.timeframe.toLowerCase(),timestamp:clock.now,user:authData.uid,author:getName(authData),meetingOpen:"true"===String(e.meetingOpen).toLowerCase(),onlyMen:"true"===String(e.onlyMen).toLowerCase(),onlyWomen:"true"===String(e.onlyWomen).toLowerCase(),childcare:"true"===String(e.childcare).toLowerCase(),meditation:"true"===String(e.meditation).toLowerCase(),speaker:"true"===String(e.speaker).toLowerCase(),step:"true"===String(e.step).toLowerCase(),spanish:"true"===String(e.spanish).toLowerCase(),bigBook:"true"===String(e.bigBook).toLowerCase(),discussion:"true"===String(e.discussion).toLowerCase(),tradition:"true"===String(e.tradition).toLowerCase(),beginner:"true"===String(e.beginner).toLowerCase(),key:t},setGeofire(t,parseFloat(e.latitude),parseFloat(e.longitude))),setCity(e.city.toLowerCase().replace(/[.$#\[\]\/]/g,""),e.state.toLowerCase(),t);var o=document.createElement("p"),i=document.createTextNode("key: "+e.key+" added.");o.className="output",o.appendChild(i),a.appendChild(o)}function dragenter(e){e.stopPropagation(),e.preventDefault()}function dragover(e){e.stopPropagation(),e.preventDefault()}function drop(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer,a=t.files;handleFileDrop(a)}function handleFileDrop(e){return window.File&&window.FileReader&&window.FileList&&window.Blob?void(e?e[0]?(file=e[0],fr=new FileReader,fr.onload=receivedText,fr.readAsText(file)):alert("Please select a file before clicking 'Load'"):alert("This browser doesn't seem to support the `files` property of file inputs.")):void alert("The File APIs are not fully supported in this browser.")}function handleFileSelect(){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob))return void alert("The File APIs are not fully supported in this browser.");console.log(event.target.id);var e=document.getElementById(event.target.id);console.log("input is "+e),e?e.files?e.files[0]?(file=e.files[0],fr=new FileReader,fr.onload=receivedText,fr.readAsText(file)):alert("Please select a file before clicking 'Load'"):alert("This browser doesn't seem to support the `files` property of file inputs."):alert("Um, couldn't find the fileinput element.")}function receivedText(){result=fr.result;var e=document.getElementById("out"),t=JSON.parse(fr.result),a=document.createElement("p"),o=1;$.each(t,function(t,i){setTimeout(function(){var t=i.state.toLowerCase(),o=i.street.toLowerCase().replace(/[.$#\[\]\/]/g,""),s=i.hour,n=i.min,r=i.day.toLowerCase(),l=i.timeframe.toLowerCase();if(-1==$.inArray(t,tools.statesArray))ref.child("meetings").orderByChild("state").equalTo(t).once("value").then(function(d){if(tools.statesArray.push(t),d.forEach(function(e){tools.meetingsArray.push(e)}),tools.isDup(t,o,s,n,r,l)){var c=document.createTextNode("Error: Duplicate Found. Key is "+i.key);a.className="output",a.appendChild(c),e.appendChild(a)}else geoCoder(i)},function(t){var o=document.createTextNode(t);a.className="output",a.appendChild(o),e.appendChild(a)});else if(tools.isDup(t,o,s,n,r,l)){var d=document.createTextNode("Error: Duplicate Found. Key is "+i.key);a.className="output",a.appendChild(d),e.appendChild(a)}else geoCoder(i)},1200*o),o++})}var ref=new Firebase("https://ack.firebaseio.com"),geofire=new GeoFire(ref.child("geofire")),authData=ref.getAuth(),meetings=ref.child("meetings"),tools=function(){var e=[],t=[];return{statesArray:e,meetingsArray:t,toast:function(e,t,a){var o=document.querySelector("#toast");t||(t=""),a||(a=2750);var i={message:e+t,timeout:a};o.MaterialSnackbar.showSnackbar(i)},isDup:function(e,a,o,i,s,n){var r=!1;return t.forEach(function(t){r=!1,e===t.val().state&&a===t.val().street&&o==t.val().hour&&i===t.val().min&&s===t.val().day&&n===t.val().timeframe&&(r=!0)}),r},isDuplicate:function(a,o,i,s,n,r){-1==$.inArray(a,e)?ref.child("meetings").orderByChild("state").equalTo(a).once("value").then(function(l){e.push(a),l.forEach(function(e){t.push(e)}),tools.isDup(a,o,i,s,n,r)?tools.toast("Error: Duplicate Found"):handleSubmit(a)},function(e){console.error(e)}):tools.isDup(a,o,i,s,n,r)?tools.toast("Error: Duplicate Found"):handleSubmit(a)},removeMeeting:function(){var e=document.querySelector("#meetingName"),t=e.dataset.key,a=document.querySelector("#meetingCity").value,o=document.querySelector("#meetingState").value;ref.child("geofire").child(t).remove(),ref.child("meetings").child(t).remove(),ref.child("states").child(o).child(a).child(t).remove(onDeleted)},removeByKey:function(e,t,a){ref.child("geofire").child(e).remove(),ref.child("meetings").child(e).remove(),ref.child("states").child(a).child(t).child(e).remove(onDeleted)}}}(),onDeleted=function(e){e?tools.toast("ERROR: Delete failed "+e):tools.toast("Meeting Deleted")},onComplete=function(e){e?tools.toast("ERROR: Synchronization failed "+e):tools.toast("SUCCESS: Synchronization succeeded")},clock={now:Date.now(),add:function(e,t){switch(t.toLowerCase()){case"weeks":val=1e3*e*60*60*24*7;break;case"days":val=1e3*e*60*60*24;break;case"hours":val=1e3*e*60*60;break;case"minutes":val=1e3*e*60;break;case"seconds":val=1e3*e;break;default:val=void 0}return val},format:function(e){var t=new Date(e),a=t.getFullYear(),o=t.getMonth()+1,i=t.getDate(),s=t.getHours(),n="0"+t.getMinutes(),r="0"+t.getSeconds();return formattedTime=o+"/"+i+"/"+a+" "+s+":"+n.substr(-2)+":"+r.substr(-2)}},states=[],days=[],tod=[],checkBoxIds=[],controller={onReady:function(){authData?loadMemberPage():(loadDiv("login"),$("#user").hide())},onLoggedIn:function(){authData=ref.getAuth(),loadMemberPage()},onLoggedOut:function(){var e=document.querySelector("#marquee");authData={},loadDiv("login"),$("#chip").hide("slow"),e.innerHTML="",tools.toast("Logged Out")}};$(document).ready(controller.onReady);